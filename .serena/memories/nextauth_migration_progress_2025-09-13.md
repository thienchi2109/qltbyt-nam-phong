Status: NextAuth v4 integrated. SessionProvider added; header/layout migrated to useSession with signOut. Converted shared components (department-filter-status, mobile-footer-nav, performance-dashboard, usage-history-tab, mobile-equipment-list-item, mobile-usage-actions) to useSession. Admin users page now uses useSession + role gate.
DB: Added enforce_hashed_password trigger; secure functions (create_user, update_user_info, change_password), dual-mode authenticate_user_dual_mode returning BIGINT. Removed non-existent user_sessions invalidation. Audit logging now writes to public.audit_logs with admin/target usernames.
Flags: AUTH_MIDDLEWARE_ENABLED (route guarding), NEXT_PUBLIC_AUTH_LEGACY_BRIDGE (legacy bridge).
Pending: Continue migrating remaining read-only components; migrate any role-gated pages; remove legacy AuthProvider and logout once all consumers are migrated; implement forced re-login after password change via password_changed_at + NextAuth JWT callback check.